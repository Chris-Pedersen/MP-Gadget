<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: MP-Gadget</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.0.dev0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MP-Gadget </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Massively Parallel Cosmological SPH Simulation Software - MP-Gadget.</p>
<h2>Description </h2>
<p>This version of Gadget is derived from main P-Gadget / Gadget-2. It is the source code used to run the BlueTides simulation (<a href="http://bluetides-project.org">http://bluetides-project.org</a>).</p>
<p>The infrastructure is heavily reworked. As a summary:</p>
<ul>
<li>A better PM solver for long range force with <a class="el" href="structPencil.html">Pencil</a> FFT.</li>
<li>A better Tree solver with faster threading and less redundant code.</li>
<li>A better Domain decomposition that scales to half a million cores.</li>
<li>A easier to use IO module with a Python binding.</li>
<li>A more intuitive parameter file parser with schema and docstrings.</li>
<li>A cleaner code base with less conditional compilation flags.</li>
</ul>
<p>Physics models:</p>
<ul>
<li>Pressure Entropy SPH and Density Entropy SPH</li>
<li>Radiation background in the expansion</li>
<li>Generic tracer particle seeding</li>
<li>Various wind feedback and blackhole feedback models</li>
<li>Various star formation criteria (need a License from Phil Hopkins before enabling)</li>
<li>Primordial and metal cooling</li>
<li>Fluctuating UV background</li>
</ul>
<h2>Installation </h2>
<p>First time users:</p>
<div class="fragment"><div class="line">git clone https://github.com/bluetides-project/MP-Gadget</div><div class="line"># or git clone https://github.com/rainwoodman/MP-Gadget-private </div><div class="line">cd MP-Gadget</div><div class="line"></div><div class="line">bash bootstrap.sh</div></div><!-- fragment --><p>We will need gsl. On HPC systems with the modules command, usually it can be loaded with</p>
<div class="fragment"><div class="line">module load gsl</div><div class="line"></div><div class="line">env | grep GSL  # check if GSL path is reasonable</div></div><!-- fragment --><p>On a common PC/Linux system, refer to your package vendor how to install gsl and gsl-devel.</p>
<p>Copy Options.mk.example to Options.mk</p>
<div class="fragment"><div class="line">cp Options.mk.example Options.mk</div></div><!-- fragment --><p>Edit Options.mk</p>
<ol type="1">
<li>Set GSL flags according to the environment variables. On coma, use Options.mk.example.coma.</li>
<li>Tweak the compilation options for 'features'. We are in the process of cleaning this up. Most options are tricky and undocumented, as Gadget. The defaults shall work for most cases; it enables Pressure-Entropy SPH and Blackhole, Cooling and SFR. To run a N-Body sim, use IC files with no gas particles.</li>
<li>For off-tree build, set DESTDIR in Options.mk; the default target is in build/</li>
</ol>
<p>Now we are ready to build</p>
<div class="fragment"><div class="line">make -j 8</div></div><!-- fragment --><p>It takes some time to build pfft, one of the bundled dependencies. Other libraries are bigfile and mp-sort, which are written by me and quick to build.</p>
<p>In the end, we will have 2 binaries:</p>
<div class="fragment"><div class="line">ls build/MP-Gadget build/MP-GenIC</div></div><!-- fragment --><ol type="1">
<li>MP-Gadget is the main simulation program.</li>
<li>MP-GenIC is the initial condition generator.</li>
</ol>
<h2>GLIBC 2.22 </h2>
<p>Cray updated their GLIBC to 2.22+ recently. A good move but it happens to be a buggy version of GLIBC: <a href="https://sourceware.org/bugzilla/show_bug.cgi?id=19590">https://sourceware.org/bugzilla/show_bug.cgi?id=19590</a> causing non-existing symbols like _ZGVcN4v___log_finite. Adding -lmvec -lmvec_nonshared to GSL_LIBS works around the issue.</p>
<h2>Usage </h2>
<p>Find examples in examples/.</p>
<ul>
<li>dm-only : Dark Matter only</li>
<li>lya : Lyman Alpha only (needs special compilcation flags)</li>
<li>hydro : hydro</li>
<li>small : hydro with low resolution</li>
</ul>
<h2>OpenMP Complication </h2>
<p>When OpenMP is switched from on to off or off to on, all of the dependencies needs to be recompiled. This can be achived by removing all files in depends/lib.</p>
<p>Otherwise symbols related to OpenMP in PFFT may be missing.</p>
<p>Always enable OpenMP.</p>
<h2>IO Format </h2>
<p>The snapshot is in bigfile format. For data analysis in Python, use</p>
<div class="fragment"><div class="line">pip install bigfile</div></div><!-- fragment --><p>Refer to <a href="https://github.com/rainwoodman/bigfile">https://github.com/rainwoodman/bigfile</a> for usage.</p>
<p>Otherwise directly open the blocks with Fortran or C, noting the data-type information and attributes in header and attrs files (in plain text)</p>
<h2>Contributors </h2>
<p>Gadget-2 was authored by Volker Springel. The original P-GADGET3 was maintained by Volker Springel</p>
<p>MP-Gadget is maintained by Yu Feng.</p>
<p>Contributors to MP-Gadget include:</p>
<p>Simeon Bird, Nicholas Battaglia, Nishikanta Khandai</p>
<h2>Citation </h2>
<p>Please cite 'Feng et al 2016 in prep'. A short paper will be written soon.</p>
<p>We need to obtain a DOI for direct citation of the software.</p>
<h2>Licence Issue </h2>
<p>Most files are licensed under GPLv2+.</p>
<p>Except two files of questionable licences: <a class="el" href="sfr__eff_8c.html">sfr_eff.c</a> and <a class="el" href="cooling_8c.html">cooling.c</a>.</p>
<p>Please refer to the source files for details.</p>
<p>The source code is put in public domain for reference. To enable features in <a class="el" href="sfr__eff_8c.html">sfr_eff.c</a> and <a class="el" href="cooling_8c.html">cooling.c</a> for scientific runs, consent from the original authors of these files shall be obtained.</p>
<h2>Status </h2>
<p>master branch on :</p>
<p><a href="https://travis-ci.org/rainwoodman/MP-Gadget"></a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
