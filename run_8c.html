<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MP-Gadget: run.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MP-Gadget
   &#160;<span id="projectnumber">5.0.0.dev0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">run.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>iterates over timesteps, main loop  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &quot;<a class="el" href="allvars_8h_source.html">allvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="proto_8h_source.html">proto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="domain_8h_source.html">domain.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cooling_8h_source.html">cooling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mymalloc_8h_source.html">mymalloc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="endrun_8h_source.html">endrun.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timestep_8h_source.html">timestep.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system_8h_source.html">system.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="drift_8h_source.html">drift.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="forcetree_8h_source.html">forcetree.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="blackhole_8h_source.html">blackhole.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hydra_8h_source.html">hydra.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sfr__eff_8h_source.html">sfr_eff.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="slotsmanager_8h_source.html">slotsmanager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fof_8h_source.html">fof.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hci_8h_source.html">hci.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for run.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c__incl.svg" width="730" height="1147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="run_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb80d08f4d52f4a7bdf28d1cecfead5b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run_8c.html#abb80d08f4d52f4a7bdf28d1cecfead5b">compute_accelerations</a> (int is_PM, int FirstStep, int GasEnabled)</td></tr>
<tr class="separator:abb80d08f4d52f4a7bdf28d1cecfead5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc59e9ee1517e4e690694a64ab6a59d2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run_8c.html#adc59e9ee1517e4e690694a64ab6a59d2">write_cpu_log</a> (int NumCurrentTiStep)</td></tr>
<tr class="separator:adc59e9ee1517e4e690694a64ab6a59d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e0ffe612d44e6d7f3a9ae5b9df56a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2">run</a> (void)</td></tr>
<tr class="separator:a05e0ffe612d44e6d7f3a9ae5b9df56a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>iterates over timesteps, main loop </p>

<p class="definition">Definition in file <a class="el" href="run_8c_source.html">run.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abb80d08f4d52f4a7bdf28d1cecfead5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb80d08f4d52f4a7bdf28d1cecfead5b">&#9670;&nbsp;</a></span>compute_accelerations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void compute_accelerations </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_PM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FirstStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>GasEnabled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This routine contains the main simulation loop that iterates over single timesteps. The loop terminates when the cpu-time limit is reached, when a `stop' file is found in the output directory, or when the simulation ends because we arrived at TimeMax.</p>
<p>This routine computes the accelerations for all active particles. First, the gravitational forces are computed. This also reconstructs the tree, if needed, otherwise the drift/kick operations have updated the tree to make it fullu usable at the current time.</p>
<p>If gas particles are presented, the `interior' of the local domain is determined. This region is guaranteed to contain only particles local to the processor. This information will be used to reduce communication in the hydro part. The density for active SPH particles is computed next. If the number of neighbours should be outside the allowed bounds, it will be readjusted by the function ensure_neighbours(), and for those particle, the densities are recomputed accordingly. Finally, the hydrodynamical forces are added. </p>

<p class="definition">Definition at line <a class="el" href="run_8c_source.html#l00190">190</a> of file <a class="el" href="run_8c_source.html">run.c</a>.</p>

<p class="reference">References <a class="el" href="timestep_8c.html#a1076ffdac0ece6476524e3fd900d39fc">ActiveParticle</a>, <a class="el" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>, <a class="el" href="blackhole_8h.html#adfcbb59c2f7bd584f549c1c4d965056b">blackhole()</a>, <a class="el" href="sfr__eff_8h.html#a4b2479c938975aa6818fcfd9b51784cd">cooling_and_starformation()</a>, <a class="el" href="sfr__eff_8c.html#aaa7b178a168a5d23b2cfe478ebc58ee1">cooling_only()</a>, <a class="el" href="density_8c.html#ad86cdeb9e3bfbe9af379ac9f7daf194c">density()</a>, <a class="el" href="global_8c.html#ae903322da17c6875ab606b032b918099">energy_statistics()</a>, <a class="el" href="forcetree_8c.html#ab3aecab620a37299d10b8013a4db5611">force_update_hmax()</a>, <a class="el" href="gravshort-tree_8c.html#a3890f7b7605d1abaf3cd23eeca5bcdd5">grav_short_tree()</a>, <a class="el" href="gravpm_8c.html#a6a55456b331c8b01d7ae1352809b82f2">gravpm_force()</a>, <a class="el" href="hydra_8c.html#a6789381bce7d1c316df8ecf04b47a607">hydro_force()</a>, <a class="el" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message()</a>, <a class="el" href="timestep_8c.html#a234d3f841781f50a25da4e8da82a0d32">NumActiveParticle</a>, <a class="el" href="structglobal__data__all__processes.html#af843a960c1f9b4cf62a6d7c61f518e90">global_data_all_processes::OutputEnergyDebug</a>, and <a class="el" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Begin force computation.\n&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">/* We do this first so that the density is up to date for</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">     * adaptive gravitational softenings. */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span>(GasEnabled)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/***** density *****/</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Start density computation...\n&quot;</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="density_8c.html#ad86cdeb9e3bfbe9af379ac9f7daf194c">density</a>();      <span class="comment">/* computes density, and pressure */</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">/***** update smoothing lengths in tree *****/</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="forcetree_8c.html#ab3aecab620a37299d10b8013a4db5611">force_update_hmax</a>(<a class="code" href="timestep_8c.html#a1076ffdac0ece6476524e3fd900d39fc">ActiveParticle</a>, <a class="code" href="timestep_8c.html#a234d3f841781f50a25da4e8da82a0d32">NumActiveParticle</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">/***** hydro forces *****/</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Start hydro-force computation...\n&quot;</span>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="hydra_8c.html#a6789381bce7d1c316df8ecf04b47a607">hydro_force</a>();      <span class="comment">/* adds hydrodynamical accelerations  and computes du/dt  */</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">/* The opening criterion for the gravtree</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">     * uses the *total* gravitational acceleration</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">     * from the last timestep, GravPM+GravAccel.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">     * So we must compute GravAccel for this timestep</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">     * before gravpm_force() writes the PM acc. for</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">     * this timestep to GravPM. Note initially both</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">     * are zero and so the tree is opened maximally</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">     * on the first timestep.*/</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="gravshort-tree_8c.html#a3890f7b7605d1abaf3cd23eeca5bcdd5">grav_short_tree</a>();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/* We use the total gravitational acc.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">     * to open the tree and total acc for the timestep.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">     * Note that any of (GravAccel, GravPM,</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">     * HydroAccel) may change much faster than</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">     * the total acc.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">     * We do the same as Gadget-2, but one could</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">     * instead use short-range tree acc. only</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">     * for opening angle or short-range timesteps,</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     * or include hydro in the opening angle.*/</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span>(is_PM)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="gravpm_8c.html#a6a55456b331c8b01d7ae1352809b82f2">gravpm_force</a>();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">/* compute and output energy statistics if desired. */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#af843a960c1f9b4cf62a6d7c61f518e90">OutputEnergyDebug</a>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <a class="code" href="global_8c.html#ae903322da17c6875ab606b032b918099">energy_statistics</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* For the first timestep, we do tree force twice</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">     * to allow usage of relative opening</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">     * criterion for consistent accuracy.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">     * This happens after PM because we want to</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">     * use the total acceleration for tree opening.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span>(FirstStep)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="gravshort-tree_8c.html#a3890f7b7605d1abaf3cd23eeca5bcdd5">grav_short_tree</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">/* Note this must be after gravaccel and hydro,</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">     * because new star particles are not in the tree,</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">     * so mass conservation would be broken.*/</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span>(GasEnabled)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#ifdef BLACK_HOLES</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">/* Black hole accretion and feedback */</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="blackhole_8h.html#adfcbb59c2f7bd584f549c1c4d965056b">blackhole</a>();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">/**** radiative cooling and star formation *****/</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#ifdef SFR</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="sfr__eff_8h.html#a4b2479c938975aa6818fcfd9b51784cd">cooling_and_starformation</a>();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="sfr__eff_8c.html#aaa7b178a168a5d23b2cfe478ebc58ee1">cooling_only</a>();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a>(0, <span class="stringliteral">&quot;Forces computed.\n&quot;</span>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div><div class="ttc" id="blackhole_8h_html_adfcbb59c2f7bd584f549c1c4d965056b"><div class="ttname"><a href="blackhole_8h.html#adfcbb59c2f7bd584f549c1c4d965056b">blackhole</a></div><div class="ttdeci">void blackhole(void)</div></div>
<div class="ttc" id="density_8c_html_ad86cdeb9e3bfbe9af379ac9f7daf194c"><div class="ttname"><a href="density_8c.html#ad86cdeb9e3bfbe9af379ac9f7daf194c">density</a></div><div class="ttdeci">void density(void)</div><div class="ttdef"><b>Definition:</b> <a href="density_8c_source.html#l00106">density.c:106</a></div></div>
<div class="ttc" id="walltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00005">walltime.h:5</a></div></div>
<div class="ttc" id="sfr__eff_8h_html_a4b2479c938975aa6818fcfd9b51784cd"><div class="ttname"><a href="sfr__eff_8h.html#a4b2479c938975aa6818fcfd9b51784cd">cooling_and_starformation</a></div><div class="ttdeci">void cooling_and_starformation(void)</div></div>
<div class="ttc" id="timestep_8c_html_a1076ffdac0ece6476524e3fd900d39fc"><div class="ttname"><a href="timestep_8c.html#a1076ffdac0ece6476524e3fd900d39fc">ActiveParticle</a></div><div class="ttdeci">int * ActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00040">timestep.c:40</a></div></div>
<div class="ttc" id="sfr__eff_8c_html_aaa7b178a168a5d23b2cfe478ebc58ee1"><div class="ttname"><a href="sfr__eff_8c.html#aaa7b178a168a5d23b2cfe478ebc58ee1">cooling_only</a></div><div class="ttdeci">void cooling_only(void)</div><div class="ttdef"><b>Definition:</b> <a href="sfr__eff_8c_source.html#l00347">sfr_eff.c:347</a></div></div>
<div class="ttc" id="hydra_8c_html_a6789381bce7d1c316df8ecf04b47a607"><div class="ttname"><a href="hydra_8c.html#a6789381bce7d1c316df8ecf04b47a607">hydro_force</a></div><div class="ttdeci">void hydro_force(void)</div><div class="ttdef"><b>Definition:</b> <a href="hydra_8c_source.html#l00090">hydra.c:90</a></div></div>
<div class="ttc" id="timestep_8c_html_a234d3f841781f50a25da4e8da82a0d32"><div class="ttname"><a href="timestep_8c.html#a234d3f841781f50a25da4e8da82a0d32">NumActiveParticle</a></div><div class="ttdeci">int NumActiveParticle</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00039">timestep.c:39</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_af843a960c1f9b4cf62a6d7c61f518e90"><div class="ttname"><a href="structglobal__data__all__processes.html#af843a960c1f9b4cf62a6d7c61f518e90">global_data_all_processes::OutputEnergyDebug</a></div><div class="ttdeci">int OutputEnergyDebug</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00354">allvars.h:354</a></div></div>
<div class="ttc" id="gravpm_8c_html_a6a55456b331c8b01d7ae1352809b82f2"><div class="ttname"><a href="gravpm_8c.html#a6a55456b331c8b01d7ae1352809b82f2">gravpm_force</a></div><div class="ttdeci">void gravpm_force(void)</div><div class="ttdef"><b>Definition:</b> <a href="gravpm_8c_source.html#l00071">gravpm.c:71</a></div></div>
<div class="ttc" id="global_8c_html_ae903322da17c6875ab606b032b918099"><div class="ttname"><a href="global_8c.html#ae903322da17c6875ab606b032b918099">energy_statistics</a></div><div class="ttdeci">void energy_statistics(void)</div><div class="ttdef"><b>Definition:</b> <a href="global_8c_source.html#l00190">global.c:190</a></div></div>
<div class="ttc" id="gravshort-tree_8c_html_a3890f7b7605d1abaf3cd23eeca5bcdd5"><div class="ttname"><a href="gravshort-tree_8c.html#a3890f7b7605d1abaf3cd23eeca5bcdd5">grav_short_tree</a></div><div class="ttdeci">void grav_short_tree(void)</div><div class="ttdef"><b>Definition:</b> <a href="gravshort-tree_8c_source.html#l00045">gravshort-tree.c:45</a></div></div>
<div class="ttc" id="endrun_8c_html_a6567cd867c5549fb6586e19ccd819764"><div class="ttname"><a href="endrun_8c.html#a6567cd867c5549fb6586e19ccd819764">message</a></div><div class="ttdeci">void message(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00226">endrun.c:226</a></div></div>
<div class="ttc" id="forcetree_8c_html_ab3aecab620a37299d10b8013a4db5611"><div class="ttname"><a href="forcetree_8c.html#ab3aecab620a37299d10b8013a4db5611">force_update_hmax</a></div><div class="ttdeci">void force_update_hmax(int *activeset, int size)</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00970">forcetree.c:970</a></div></div>
<div class="ttc" id="allvars_8c_html_ad49123ae0461ffe61629a0d4cf2ba91f"><div class="ttname"><a href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a></div><div class="ttdeci">struct global_data_all_processes All</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00047">allvars.c:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_abb80d08f4d52f4a7bdf28d1cecfead5b_cgraph.svg" width="1259" height="1538"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_abb80d08f4d52f4a7bdf28d1cecfead5b_icgraph.svg" width="663" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a05e0ffe612d44e6d7f3a9ae5b9df56a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e0ffe612d44e6d7f3a9ae5b9df56a2">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="run_8c_source.html#l00038">38</a> of file <a class="el" href="run_8c_source.html">run.c</a>.</p>

<p class="reference">References <a class="el" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>, <a class="el" href="timestep_8c.html#a369dd5aca226397988138db95a8496b0">apply_half_kick()</a>, <a class="el" href="timestep_8c.html#a6aa36b502b9220d87050ae0c28d533d8">apply_PM_half_kick()</a>, <a class="el" href="run_8c.html#abb80d08f4d52f4a7bdf28d1cecfead5b">compute_accelerations()</a>, <a class="el" href="domain_8c.html#a168c36ec12faca23e23395b6a13d2037">domain_decompose_full()</a>, <a class="el" href="domain_8c.html#acf7b74bdcb6563a4603538914fc16157">domain_maintain()</a>, <a class="el" href="drift_8c.html#af3e58fb1ffbcc5aed5ce57df71c580e2">drift_all_particles()</a>, <a class="el" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun()</a>, <a class="el" href="timebinmgr_8c.html#aa1c832d9a92b9e906dbae0c9a7be298c">find_current_sync_point()</a>, <a class="el" href="timestep_8c.html#aa7119c29751fcd9275f395e6ea08965f">find_next_kick()</a>, <a class="el" href="timebinmgr_8c.html#a4a7f3606a4cb958089f232db3fc51dd2">find_next_sync_point()</a>, <a class="el" href="timestep_8c.html#ac4c17d0cf055339694fdd96baadd83c0">find_timesteps()</a>, <a class="el" href="forcetree_8c.html#a45a1a710bd7d997dbe7cf22a7600b731">force_tree_rebuild()</a>, <a class="el" href="hci_8c.html#adf575054e41280d79cdcad95d436b33d">hci_action_init()</a>, <a class="el" href="hci_8c.html#a394fed67bae7e3db82a72073a19cc059">HCI_DEFAULT_MANAGER</a>, <a class="el" href="hci_8c.html#ab140bce619153b809e0fea49a2e1d081">hci_query()</a>, <a class="el" href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28">HCI_TERMINATE</a>, <a class="el" href="timestep_8c.html#a091981158d46c55661f089fc2812dc69">is_PM_timestep()</a>, <a class="el" href="timebinmgr_8c.html#a90eb3a2bdca47035148249e68fc244be">loga_from_ti()</a>, <a class="el" href="structglobal__data__all__processes.html#ab213f81cb93290e0e240488f3846495b">global_data_all_processes::NTotalInit</a>, <a class="el" href="timestep_8c.html#a213824fd52a446328b5b432c1b4b5c48">print_timebin_statistics()</a>, <a class="el" href="timestep_8c.html#ad04ae4be74d1729309b2a51cdc72e006">rebuild_activelist()</a>, <a class="el" href="mymalloc_8h.html#afaf046f010cd01115a573a59e1e73e01">report_memory_usage</a>, <a class="el" href="timestep_8c.html#aaebcb31d8cb374d360e1e165df6fe26d">set_global_time()</a>, <a class="el" href="system_8c.html#a9cb45ef22cae101906f021fb7a23afbe">set_random_numbers()</a>, <a class="el" href="slotsmanager_8c.html#a4f5a9c6b3e3d8049f173cd3a5fb9c983">slots_gc()</a>, <a class="el" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">global_data_all_processes::Ti_Current</a>, <a class="el" href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">global_data_all_processes::Time</a>, <a class="el" href="structglobal__data__all__processes.html#a05a40a90ec77ac379054f82acbec87dc">global_data_all_processes::TimeStep</a>, <a class="el" href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">HCIAction::type</a>, <a class="el" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>, <a class="el" href="io_8c.html#abebc4bd687935fe63fcb27a9767e5ded">write_checkpoint()</a>, <a class="el" href="run_8c.html#adc59e9ee1517e4e690694a64ab6a59d2">write_cpu_log()</a>, <a class="el" href="structSyncPoint.html#a4423ca022f08153c9ae086784e97565b">SyncPoint::write_fof</a>, <a class="el" href="structSyncPoint.html#af86f979490f9dd8cf7e9488f2c68503c">SyncPoint::write_snapshot</a>, and <a class="el" href="structHCIAction.html#a60b86f3851076753015f6025945edf91">HCIAction::write_snapshot</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;{</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/*Number of timesteps performed this run*/</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> NumCurrentTiStep = 0;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">/*Minimum occupied timebin. Initially (but never again) zero*/</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">int</span> minTimeBin = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">/*Is gas physics enabled?*/</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> GasEnabled = <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#ab213f81cb93290e0e240488f3846495b">NTotalInit</a>[0] &gt; 0;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a>(<span class="stringliteral">&quot;/Misc&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="run_8c.html#adc59e9ee1517e4e690694a64ab6a59d2">write_cpu_log</a>(NumCurrentTiStep); <span class="comment">/* produce some CPU usage info */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">while</span>(1) <span class="comment">/* main loop */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">/* Find next synchronization point and the timebins active during this timestep.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">         * Note that on startup, P[i].TimeBin == 0 for all particles,</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">         * all bins except the zeroth are inactive and so we return 0 from this function.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">         * This ensures we run the force calculation for the first timestep.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a> = <a class="code" href="timestep_8c.html#aa7119c29751fcd9275f395e6ea08965f">find_next_kick</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>, minTimeBin);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">/*Convert back to floating point time*/</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="timestep_8c.html#aaebcb31d8cb374d360e1e165df6fe26d">set_global_time</a>(exp(<a class="code" href="timebinmgr_8c.html#a90eb3a2bdca47035148249e68fc244be">loga_from_ti</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>)));</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/*1.0 check for rate setting in sfr_eff.c*/</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span>(NumCurrentTiStep &gt; 0 &amp;&amp; <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a05a40a90ec77ac379054f82acbec87dc">TimeStep</a> &lt; 0)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(1, <span class="stringliteral">&quot;Negative timestep: %g New Time: %g!\n&quot;</span>, <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a05a40a90ec77ac379054f82acbec87dc">TimeStep</a>, <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">Time</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">int</span> is_PM = <a class="code" href="timestep_8c.html#a091981158d46c55661f089fc2812dc69">is_PM_timestep</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="structSyncPoint.html">SyncPoint</a> * next_sync; <span class="comment">/* if we are out of planned sync points, terminate */</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="structSyncPoint.html">SyncPoint</a> * planned_sync; <span class="comment">/* NULL; if the step is not a planned sync point. */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        next_sync = <a class="code" href="timebinmgr_8c.html#a4a7f3606a4cb958089f232db3fc51dd2">find_next_sync_point</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        planned_sync = <a class="code" href="timebinmgr_8c.html#aa1c832d9a92b9e906dbae0c9a7be298c">find_current_sync_point</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="structHCIAction.html">HCIAction</a> action[1];</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="hci_8c.html#adf575054e41280d79cdcad95d436b33d">hci_action_init</a>(action); <span class="comment">/* init to no action */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">int</span> stop = 0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="comment">/* query HCI requests only on PM step; where kick and drifts are synced */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            stop = <a class="code" href="hci_8c.html#ab140bce619153b809e0fea49a2e1d081">hci_query</a>(<a class="code" href="hci_8c.html#a394fed67bae7e3db82a72073a19cc059">HCI_DEFAULT_MANAGER</a>, action);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">if</span>(action-&gt;<a class="code" href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">type</a> == <a class="code" href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28">HCI_TERMINATE</a>) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <a class="code" href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a>(0, <span class="stringliteral">&quot;Human triggered termination.\n&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">/* Sync positions of all particles */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="drift_8c.html#af3e58fb1ffbcc5aed5ce57df71c580e2">drift_all_particles</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">/* drift and domain decomposition */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">/* at first step this is a noop */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">/* full decomposition rebuilds the tree */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="domain_8c.html#a168c36ec12faca23e23395b6a13d2037">domain_decompose_full</a>();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">/* FIXME: add a parameter for domain_decompose_incremental */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="comment">/* currently we drift all particles every step */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="comment">/* If it is not a PM step, do a shorter version</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">             * of the domain decomp which just moves and exchanges drifted (active) particles.*/</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="domain_8c.html#acf7b74bdcb6563a4603538914fc16157">domain_maintain</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="timestep_8c.html#ad04ae4be74d1729309b2a51cdc72e006">rebuild_activelist</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="timestep_8c.html#a213824fd52a446328b5b432c1b4b5c48">print_timebin_statistics</a>(NumCurrentTiStep);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="system_8c.html#a9cb45ef22cae101906f021fb7a23afbe">set_random_numbers</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">/* update force to Ti_Current */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="run_8c.html#abb80d08f4d52f4a7bdf28d1cecfead5b">compute_accelerations</a>(is_PM, NumCurrentTiStep == 0, GasEnabled);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">/* Update velocity to Ti_Current; this synchonizes TiKick and TiDrift for the active particles */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <a class="code" href="timestep_8c.html#a6aa36b502b9220d87050ae0c28d533d8">apply_PM_half_kick</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="timestep_8c.html#a369dd5aca226397988138db95a8496b0">apply_half_kick</a>();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">/* If a snapshot is requested, write it.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">         * write_checkpoint is responsible to maintain a valid domain and tree after it is called.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">         * We only attempt to output on sync points. This is the only chance where all variables are</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">         * synchonized in a consistent state in a K(KDDK)^mK scheme.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">int</span> WriteSnapshot = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">int</span> WriteFOF = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">if</span>(planned_sync) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            WriteSnapshot |= planned_sync-&gt;<a class="code" href="structSyncPoint.html#af86f979490f9dd8cf7e9488f2c68503c">write_snapshot</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            WriteFOF |= planned_sync-&gt;<a class="code" href="structSyncPoint.html#a4423ca022f08153c9ae086784e97565b">write_fof</a>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">if</span>(is_PM) { <span class="comment">/* the if here is unnecessary but to signify checkpointing occurs only at PM steps. */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            WriteSnapshot |= action-&gt;<a class="code" href="structHCIAction.html#a60b86f3851076753015f6025945edf91">write_snapshot</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span>(WriteSnapshot) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="comment">/* The accel may have created garbage -- collect them before writing a snapshot.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">             * If we do collect, rebuild tree and active list.*/</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordtype">int</span> compact[6] = {0};</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="slotsmanager_8c.html#a4f5a9c6b3e3d8049f173cd3a5fb9c983">slots_gc</a>(compact)) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="forcetree_8c.html#a45a1a710bd7d997dbe7cf22a7600b731">force_tree_rebuild</a>();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="timestep_8c.html#ad04ae4be74d1729309b2a51cdc72e006">rebuild_activelist</a>(<a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">Ti_Current</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="io_8c.html#abebc4bd687935fe63fcb27a9767e5ded">write_checkpoint</a>(WriteSnapshot, WriteFOF);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="run_8c.html#adc59e9ee1517e4e690694a64ab6a59d2">write_cpu_log</a>(NumCurrentTiStep);        <span class="comment">/* produce some CPU usage info */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        NumCurrentTiStep++;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="mymalloc_8h.html#afaf046f010cd01115a573a59e1e73e01">report_memory_usage</a>(<span class="stringliteral">&quot;RUN&quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span>(!next_sync || stop) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">/* out of sync points, or a requested stop, the run has finally finished! Yay.*/</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">/* more steps to go. */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">/* assign new timesteps to the active particles, now that we know they have synched TiKick and TiDrift */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="timestep_8c.html#ac4c17d0cf055339694fdd96baadd83c0">find_timesteps</a>(&amp;minTimeBin);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">/* Update velocity to the new step, with the newly computed step size */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="timestep_8c.html#a369dd5aca226397988138db95a8496b0">apply_half_kick</a>();</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span>(is_PM) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="timestep_8c.html#a6aa36b502b9220d87050ae0c28d533d8">apply_PM_half_kick</a>();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div><div class="ttc" id="structglobal__data__all__processes_html_aac685530de56448068f8dd037fc56490"><div class="ttname"><a href="structglobal__data__all__processes.html#aac685530de56448068f8dd037fc56490">global_data_all_processes::Ti_Current</a></div><div class="ttdeci">inttime_t Ti_Current</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00282">allvars.h:282</a></div></div>
<div class="ttc" id="hci_8c_html_adf575054e41280d79cdcad95d436b33d"><div class="ttname"><a href="hci_8c.html#adf575054e41280d79cdcad95d436b33d">hci_action_init</a></div><div class="ttdeci">void hci_action_init(HCIAction *action)</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00042">hci.c:42</a></div></div>
<div class="ttc" id="io_8c_html_abebc4bd687935fe63fcb27a9767e5ded"><div class="ttname"><a href="io_8c.html#abebc4bd687935fe63fcb27a9767e5ded">write_checkpoint</a></div><div class="ttdeci">void write_checkpoint(int WriteSnapshot, int WriteFOF)</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00025">io.c:25</a></div></div>
<div class="ttc" id="timestep_8c_html_ac4c17d0cf055339694fdd96baadd83c0"><div class="ttname"><a href="timestep_8c.html#ac4c17d0cf055339694fdd96baadd83c0">find_timesteps</a></div><div class="ttdeci">int find_timesteps(int *MinTimeBin)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00131">timestep.c:131</a></div></div>
<div class="ttc" id="slotsmanager_8c_html_a4f5a9c6b3e3d8049f173cd3a5fb9c983"><div class="ttname"><a href="slotsmanager_8c.html#a4f5a9c6b3e3d8049f173cd3a5fb9c983">slots_gc</a></div><div class="ttdeci">int slots_gc(int *compact_slots)</div><div class="ttdef"><b>Definition:</b> <a href="slotsmanager_8c_source.html#l00121">slotsmanager.c:121</a></div></div>
<div class="ttc" id="endrun_8c_html_ad963d7efdb9f10f7a2298c8ccd222ab0"><div class="ttname"><a href="endrun_8c.html#ad963d7efdb9f10f7a2298c8ccd222ab0">endrun</a></div><div class="ttdeci">void endrun(int where, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="endrun_8c_source.html#l00210">endrun.c:210</a></div></div>
<div class="ttc" id="timestep_8c_html_aa7119c29751fcd9275f395e6ea08965f"><div class="ttname"><a href="timestep_8c.html#aa7119c29751fcd9275f395e6ea08965f">find_next_kick</a></div><div class="ttdeci">inttime_t find_next_kick(inttime_t Ti_Current, int minTimeBin)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00676">timestep.c:676</a></div></div>
<div class="ttc" id="domain_8c_html_acf7b74bdcb6563a4603538914fc16157"><div class="ttname"><a href="domain_8c.html#acf7b74bdcb6563a4603538914fc16157">domain_maintain</a></div><div class="ttdeci">void domain_maintain(void)</div><div class="ttdef"><b>Definition:</b> <a href="domain_8c_source.html#l00224">domain.c:224</a></div></div>
<div class="ttc" id="drift_8c_html_af3e58fb1ffbcc5aed5ce57df71c580e2"><div class="ttname"><a href="drift_8c.html#af3e58fb1ffbcc5aed5ce57df71c580e2">drift_all_particles</a></div><div class="ttdeci">void drift_all_particles(inttime_t ti1)</div><div class="ttdef"><b>Definition:</b> <a href="drift_8c_source.html#l00177">drift.c:177</a></div></div>
<div class="ttc" id="walltime_8h_html_a2d23071e44d020b4a0b3f2876667d370"><div class="ttname"><a href="walltime_8h.html#a2d23071e44d020b4a0b3f2876667d370">walltime_measure</a></div><div class="ttdeci">#define walltime_measure(name)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00005">walltime.h:5</a></div></div>
<div class="ttc" id="structHCIAction_html_a5b7387d5b3a88f5b5389153cc585a07c"><div class="ttname"><a href="structHCIAction.html#a5b7387d5b3a88f5b5389153cc585a07c">HCIAction::type</a></div><div class="ttdeci">enum HCIActionType type</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00028">hci.h:28</a></div></div>
<div class="ttc" id="hci_8c_html_ab140bce619153b809e0fea49a2e1d081"><div class="ttname"><a href="hci_8c.html#ab140bce619153b809e0fea49a2e1d081">hci_query</a></div><div class="ttdeci">int hci_query(HCIManager *manager, HCIAction *action)</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00155">hci.c:155</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_a05a40a90ec77ac379054f82acbec87dc"><div class="ttname"><a href="structglobal__data__all__processes.html#a05a40a90ec77ac379054f82acbec87dc">global_data_all_processes::TimeStep</a></div><div class="ttdeci">double TimeStep</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00267">allvars.h:267</a></div></div>
<div class="ttc" id="timestep_8c_html_a369dd5aca226397988138db95a8496b0"><div class="ttname"><a href="timestep_8c.html#a369dd5aca226397988138db95a8496b0">apply_half_kick</a></div><div class="ttdeci">void apply_half_kick(void)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00239">timestep.c:239</a></div></div>
<div class="ttc" id="structSyncPoint_html"><div class="ttname"><a href="structSyncPoint.html">SyncPoint</a></div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00019">timebinmgr.h:19</a></div></div>
<div class="ttc" id="structHCIAction_html_a60b86f3851076753015f6025945edf91"><div class="ttname"><a href="structHCIAction.html#a60b86f3851076753015f6025945edf91">HCIAction::write_snapshot</a></div><div class="ttdeci">int write_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00029">hci.h:29</a></div></div>
<div class="ttc" id="domain_8c_html_a168c36ec12faca23e23395b6a13d2037"><div class="ttname"><a href="domain_8c.html#a168c36ec12faca23e23395b6a13d2037">domain_decompose_full</a></div><div class="ttdeci">void domain_decompose_full(void)</div><div class="ttdef"><b>Definition:</b> <a href="domain_8c_source.html#l00133">domain.c:133</a></div></div>
<div class="ttc" id="structHCIAction_html"><div class="ttname"><a href="structHCIAction.html">HCIAction</a></div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00026">hci.h:26</a></div></div>
<div class="ttc" id="forcetree_8c_html_a45a1a710bd7d997dbe7cf22a7600b731"><div class="ttname"><a href="forcetree_8c.html#a45a1a710bd7d997dbe7cf22a7600b731">force_tree_rebuild</a></div><div class="ttdeci">void force_tree_rebuild()</div><div class="ttdef"><b>Definition:</b> <a href="forcetree_8c_source.html#l00101">forcetree.c:101</a></div></div>
<div class="ttc" id="timebinmgr_8c_html_aa1c832d9a92b9e906dbae0c9a7be298c"><div class="ttname"><a href="timebinmgr_8c.html#aa1c832d9a92b9e906dbae0c9a7be298c">find_current_sync_point</a></div><div class="ttdeci">SyncPoint * find_current_sync_point(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00105">timebinmgr.c:105</a></div></div>
<div class="ttc" id="timestep_8c_html_ad04ae4be74d1729309b2a51cdc72e006"><div class="ttname"><a href="timestep_8c.html#ad04ae4be74d1729309b2a51cdc72e006">rebuild_activelist</a></div><div class="ttdeci">int rebuild_activelist(inttime_t Ti_Current)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00683">timestep.c:683</a></div></div>
<div class="ttc" id="timestep_8c_html_a213824fd52a446328b5b432c1b4b5c48"><div class="ttname"><a href="timestep_8c.html#a213824fd52a446328b5b432c1b4b5c48">print_timebin_statistics</a></div><div class="ttdeci">void print_timebin_statistics(int NumCurrentTiStep)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00710">timestep.c:710</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_a25b9da73fdcbdc45fbe4a6ad45479f09"><div class="ttname"><a href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">global_data_all_processes::Time</a></div><div class="ttdeci">double Time</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00267">allvars.h:267</a></div></div>
<div class="ttc" id="system_8c_html_a9cb45ef22cae101906f021fb7a23afbe"><div class="ttname"><a href="system_8c.html#a9cb45ef22cae101906f021fb7a23afbe">set_random_numbers</a></div><div class="ttdeci">void set_random_numbers(void)</div><div class="ttdef"><b>Definition:</b> <a href="system_8c_source.html#l00124">system.c:124</a></div></div>
<div class="ttc" id="mymalloc_8h_html_afaf046f010cd01115a573a59e1e73e01"><div class="ttname"><a href="mymalloc_8h.html#afaf046f010cd01115a573a59e1e73e01">report_memory_usage</a></div><div class="ttdeci">#define report_memory_usage(x)</div><div class="ttdef"><b>Definition:</b> <a href="mymalloc_8h_source.html#l00027">mymalloc.h:27</a></div></div>
<div class="ttc" id="timebinmgr_8c_html_a4a7f3606a4cb958089f232db3fc51dd2"><div class="ttname"><a href="timebinmgr_8c.html#a4a7f3606a4cb958089f232db3fc51dd2">find_next_sync_point</a></div><div class="ttdeci">SyncPoint * find_next_sync_point(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00091">timebinmgr.c:91</a></div></div>
<div class="ttc" id="timebinmgr_8c_html_a90eb3a2bdca47035148249e68fc244be"><div class="ttname"><a href="timebinmgr_8c.html#a90eb3a2bdca47035148249e68fc244be">loga_from_ti</a></div><div class="ttdeci">double loga_from_ti(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8c_source.html#l00140">timebinmgr.c:140</a></div></div>
<div class="ttc" id="timestep_8c_html_a091981158d46c55661f089fc2812dc69"><div class="ttname"><a href="timestep_8c.html#a091981158d46c55661f089fc2812dc69">is_PM_timestep</a></div><div class="ttdeci">int is_PM_timestep(inttime_t ti)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00104">timestep.c:104</a></div></div>
<div class="ttc" id="timestep_8c_html_a6aa36b502b9220d87050ae0c28d533d8"><div class="ttname"><a href="timestep_8c.html#a6aa36b502b9220d87050ae0c28d533d8">apply_PM_half_kick</a></div><div class="ttdeci">void apply_PM_half_kick(void)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00261">timestep.c:261</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_ab213f81cb93290e0e240488f3846495b"><div class="ttname"><a href="structglobal__data__all__processes.html#ab213f81cb93290e0e240488f3846495b">global_data_all_processes::NTotalInit</a></div><div class="ttdeci">int64_t NTotalInit[6]</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00157">allvars.h:157</a></div></div>
<div class="ttc" id="hci_8h_html_aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28"><div class="ttname"><a href="hci_8h.html#aab3c66bd8d0f209c23a32209638ccbe1a3138a1dc4b0d345ec618539b80522d28">HCI_TERMINATE</a></div><div class="ttdef"><b>Definition:</b> <a href="hci_8h_source.html#l00022">hci.h:22</a></div></div>
<div class="ttc" id="run_8c_html_adc59e9ee1517e4e690694a64ab6a59d2"><div class="ttname"><a href="run_8c.html#adc59e9ee1517e4e690694a64ab6a59d2">write_cpu_log</a></div><div class="ttdeci">static void write_cpu_log(int NumCurrentTiStep)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00270">run.c:270</a></div></div>
<div class="ttc" id="structSyncPoint_html_a4423ca022f08153c9ae086784e97565b"><div class="ttname"><a href="structSyncPoint.html#a4423ca022f08153c9ae086784e97565b">SyncPoint::write_fof</a></div><div class="ttdeci">int write_fof</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00024">timebinmgr.h:24</a></div></div>
<div class="ttc" id="structSyncPoint_html_af86f979490f9dd8cf7e9488f2c68503c"><div class="ttname"><a href="structSyncPoint.html#af86f979490f9dd8cf7e9488f2c68503c">SyncPoint::write_snapshot</a></div><div class="ttdeci">int write_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="timebinmgr_8h_source.html#l00023">timebinmgr.h:23</a></div></div>
<div class="ttc" id="run_8c_html_abb80d08f4d52f4a7bdf28d1cecfead5b"><div class="ttname"><a href="run_8c.html#abb80d08f4d52f4a7bdf28d1cecfead5b">compute_accelerations</a></div><div class="ttdeci">static void compute_accelerations(int is_PM, int FirstStep, int GasEnabled)</div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00190">run.c:190</a></div></div>
<div class="ttc" id="timestep_8c_html_aaebcb31d8cb374d360e1e165df6fe26d"><div class="ttname"><a href="timestep_8c.html#aaebcb31d8cb374d360e1e165df6fe26d">set_global_time</a></div><div class="ttdeci">void set_global_time(double newtime)</div><div class="ttdef"><b>Definition:</b> <a href="timestep_8c_source.html#l00113">timestep.c:113</a></div></div>
<div class="ttc" id="hci_8c_html_a394fed67bae7e3db82a72073a19cc059"><div class="ttname"><a href="hci_8c.html#a394fed67bae7e3db82a72073a19cc059">HCI_DEFAULT_MANAGER</a></div><div class="ttdeci">HCIManager HCI_DEFAULT_MANAGER[1]</div><div class="ttdef"><b>Definition:</b> <a href="hci_8c_source.html#l00011">hci.c:11</a></div></div>
<div class="ttc" id="allvars_8c_html_ad49123ae0461ffe61629a0d4cf2ba91f"><div class="ttname"><a href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a></div><div class="ttdeci">struct global_data_all_processes All</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00047">allvars.c:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_a05e0ffe612d44e6d7f3a9ae5b9df56a2_cgraph.svg" width="906" height="1955"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_a05e0ffe612d44e6d7f3a9ae5b9df56a2_icgraph.svg" width="459" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adc59e9ee1517e4e690694a64ab6a59d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc59e9ee1517e4e690694a64ab6a59d2">&#9670;&nbsp;</a></span>write_cpu_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void write_cpu_log </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NumCurrentTiStep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="run_8c_source.html#l00270">270</a> of file <a class="el" href="run_8c_source.html">run.c</a>.</p>

<p class="reference">References <a class="el" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>, <a class="el" href="structglobal__data__all__processes.html#af29c17c6e88b798d3dad38b719b817ed">global_data_all_processes::CT</a>, <a class="el" href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ClockTable::ElapsedTime</a>, <a class="el" href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a>, <a class="el" href="allvars_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>, <a class="el" href="structglobal__data__all__processes.html#a8e038ee0e682cc8b6e5ac27b849253c5">global_data_all_processes::NumThreads</a>, <a class="el" href="allvars_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a>, <a class="el" href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">global_data_all_processes::Time</a>, <a class="el" href="walltime_8c.html#ad55e251cf4be78674e5f1ff3cfa74ba7">walltime_report()</a>, and <a class="el" href="walltime_8c.html#a44ebd264165684ad7bed2d5bf4e02e22">walltime_summary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="run_8c.html#a05e0ffe612d44e6d7f3a9ae5b9df56a2">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;{</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="walltime_8c.html#a44ebd264165684ad7bed2d5bf4e02e22">walltime_summary</a>(0, MPI_COMM_WORLD);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="allvars_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        fprintf(<a class="code" href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a>, <span class="stringliteral">&quot;Step %d, Time: %g, MPIs: %d Threads: %d Elapsed: %g\n&quot;</span>, NumCurrentTiStep, <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">Time</a>, <a class="code" href="allvars_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a>, <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#a8e038ee0e682cc8b6e5ac27b849253c5">NumThreads</a>, <a class="code" href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a>.<a class="code" href="structglobal__data__all__processes.html#af29c17c6e88b798d3dad38b719b817ed">CT</a>.<a class="code" href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ElapsedTime</a>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        fflush(<a class="code" href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="walltime_8c.html#ad55e251cf4be78674e5f1ff3cfa74ba7">walltime_report</a>(<a class="code" href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a>, 0, MPI_COMM_WORLD);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="allvars_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a> == 0) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        fflush(<a class="code" href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="ttc" id="structglobal__data__all__processes_html_a8e038ee0e682cc8b6e5ac27b849253c5"><div class="ttname"><a href="structglobal__data__all__processes.html#a8e038ee0e682cc8b6e5ac27b849253c5">global_data_all_processes::NumThreads</a></div><div class="ttdeci">int NumThreads</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00169">allvars.h:169</a></div></div>
<div class="ttc" id="walltime_8c_html_a44ebd264165684ad7bed2d5bf4e02e22"><div class="ttname"><a href="walltime_8c.html#a44ebd264165684ad7bed2d5bf4e02e22">walltime_summary</a></div><div class="ttdeci">void walltime_summary(int root, MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8c_source.html#l00053">walltime.c:53</a></div></div>
<div class="ttc" id="allvars_8c_html_aeaf0bacb2c9ca3f63d21ce9ca26b4992"><div class="ttname"><a href="allvars_8c.html#aeaf0bacb2c9ca3f63d21ce9ca26b4992">FdCPU</a></div><div class="ttdeci">FILE * FdCPU</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00031">allvars.c:31</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_af29c17c6e88b798d3dad38b719b817ed"><div class="ttname"><a href="structglobal__data__all__processes.html#af29c17c6e88b798d3dad38b719b817ed">global_data_all_processes::CT</a></div><div class="ttdeci">struct ClockTable CT</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00289">allvars.h:289</a></div></div>
<div class="ttc" id="allvars_8c_html_a675acdcd149f5993271a1fdc11673b65"><div class="ttname"><a href="allvars_8c.html#a675acdcd149f5993271a1fdc11673b65">NTask</a></div><div class="ttdeci">int NTask</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00025">allvars.c:25</a></div></div>
<div class="ttc" id="allvars_8c_html_a52c8c7d2abff436111942e02c5bb466a"><div class="ttname"><a href="allvars_8c.html#a52c8c7d2abff436111942e02c5bb466a">ThisTask</a></div><div class="ttdeci">int ThisTask</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00024">allvars.c:24</a></div></div>
<div class="ttc" id="structglobal__data__all__processes_html_a25b9da73fdcbdc45fbe4a6ad45479f09"><div class="ttname"><a href="structglobal__data__all__processes.html#a25b9da73fdcbdc45fbe4a6ad45479f09">global_data_all_processes::Time</a></div><div class="ttdeci">double Time</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8h_source.html#l00267">allvars.h:267</a></div></div>
<div class="ttc" id="structClockTable_html_a4cca76e9c7472e9fca344568b1021522"><div class="ttname"><a href="structClockTable.html#a4cca76e9c7472e9fca344568b1021522">ClockTable::ElapsedTime</a></div><div class="ttdeci">double ElapsedTime</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8h_source.html#l00051">walltime.h:51</a></div></div>
<div class="ttc" id="walltime_8c_html_ad55e251cf4be78674e5f1ff3cfa74ba7"><div class="ttname"><a href="walltime_8c.html#ad55e251cf4be78674e5f1ff3cfa74ba7">walltime_report</a></div><div class="ttdeci">void walltime_report(FILE *fp, int root, MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="walltime_8c_source.html#l00213">walltime.c:213</a></div></div>
<div class="ttc" id="allvars_8c_html_ad49123ae0461ffe61629a0d4cf2ba91f"><div class="ttname"><a href="allvars_8c.html#ad49123ae0461ffe61629a0d4cf2ba91f">All</a></div><div class="ttdeci">struct global_data_all_processes All</div><div class="ttdef"><b>Definition:</b> <a href="allvars_8c_source.html#l00047">allvars.c:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_adc59e9ee1517e4e690694a64ab6a59d2_cgraph.svg" width="1248" height="1944"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="run_8c_adc59e9ee1517e4e690694a64ab6a59d2_icgraph.svg" width="459" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
